# 14장: 보안 HTTP

## 14.1 HTTP를 안전하게 만들기

앞서 살폈던 인증들은 보안이 충분하지 않다. 보다 안전하기 위해서는 HTTP와 디지털 암호화 기술을 결합해야 한다.

* 서버 인증 - 클라이언트는 자신이 위조된 서버가 아닌 진짜와 이야기하고 있음을 알 수 있어야 한다.
* 클라이언트 인증 - 서버는 자신이 가짜가 아닌 진짜 사용자와 이야기하고 있음을 알 수 있어야 한다.
* 무결성 - 클라이언트와 서버는 그들의 데이터가 위조되는 것으로부터 안전해야 한다.
* 암호화 - 클라이언트와 서버는 도청에 대한 걱정 없이 서로 대화할 수 있어야 한다.
* 효율 - 저렴한 클라이언트나 서버도 이용할 수 있도록 알고리즘은 충분히 빨라야 한다.
* 편재성(Ubiquity) - 프로토콜은 거의 모든 클라이언트와 서버에서 지원되어야 한다.
* 관리상 확장성 - 누구든 어디서든 즉각적인 보안 통신을 할 수 있어야 한다.
* 적응성 - 현재 알려진 최선의 보안 방법을 지원해야 한다.
* 사회적 생존성 - 사회의 문화적, 정치적 요구를 만족시켜야 한다.


### 14.1.1 HTTPS

HTTP를 안전하게 만드는 방식 중에서 가장 인기 있는 것.
웹페이지에 HTTP가 아닌 HTTPS로 접근하고 있는 경우, https://로 URL이 시작된다.

HTTPS를 사용할 때, 모든 HTTP 요청과 응답 데이터는 네트워크로 보내지기 전에 암호화된다.
HTTPS는 HTTP의 하부에 전송 레벨 암호 보안 계층을 제공함으로써 동작하고 이 보안 계층은 안전 소켓 계층(Secure Sockets Layer, SSL) 혹은 그를 계승한 전송 계층 보안(Transport Layer Security, TLS)을 이용해서 구현된다.

어려운 인코딩 및 디코딩 작업은 대부분 SSL 라이브러리 안에서 일어나기 때문에, 웹 클라이언트와 서버가 프로토콜을 처리하는 로직을 크게 변경할 필요는 없다.


## 14.2 디지털 암호학

* 암호 - 텍스트를 아무나 읽지 못하도록 인코딩하는 알고리즘
* 키 - 암호의 동작을 변경하는 숫자로 된 매개변수
* 대칭키 암호 체계 - 인코딩과 디코딩에 다른 키를 사용하는 알고리즘
* 공개키 암호법 - 비밀 베시지를 전달하는 수백만 대의 컴퓨터를 쉽게 만들 수 있는 시스템
* 디지털 서명 - 메시지가 위조 혹은 변조되지 않았음을 입증하는 체크섬
* 디지털 인증서 - 신뢰할 만한 조직에 의해 서명되고 검증된 신원 확인 정보


### 14.2.1 비밀 코드의 기술과 과학

### 14.2.2 암호(cipher)

암호법은 암호라 불리는 비밀 코드에 기반한다. 암호란 메시지를 인코딩하는 어떤 특정한 방법과 나중에 그 비밀 메시지를 디코딩하는 방법이다.
인코딩되기 전의 원본 메시지는 흔히 텍스트 혹은 평문이라 불린다. 암호가 적용되어 코딩된 메시지는 보통 암호문이라고 불린다.

### 14.2.3 암호 기계

기술이 진보하면서 사람들은 보다 복잡한 암호로 메시지를 빠르고 정확하게 인코딩하고 디코딩하는 기계를 만들기 시작했다.

### 14.2.4 키가 있는 암호

암호 기계를 누군가 훔치더라도, 올바른 다이얼 설정(키 값)이 없이는 디코더가 동작하지 않을 것이다.
이러한 암호 매개변수를 키라고 부른다. 디코딩을 바르게 동작시키려면 올바른 키를 암호 기계에 입력할 필요가 있다. 

### 14.2.5 디지털 암호

* 속도 및 기능에 대한 기계 장치의 한계에서 벗어남으로써, 복잡한 인코딩과 디코딩 알고리즘이 가능해졌다.
* 매우 큰 키를 지원하는 것이 가능해져서, 단일 암호 알고리즘으로 키의 값마다 다른 수조 개의 가상 암호 알고리즘을 만들어낼 수 있게 되었다.
키가 길수록 인코딩의 많은 조합이 가능해지고 무작위로 추측한 키에 의한 크래킹이 어려워진다. 


## 14.3 대칭키 암호법

많은 디지털 암호 알고리즘은 대칭키 암호라 불린다. 인코딩할 때 사용하는 키가 디코딩을 할 때와 같기 때문이다. 

이 경우 발송자와 수신자 모두 통신을 위해 비밀 키를 똑같이 공유할 필요가 있다. 

잘 알려진 대칭키 암호 알고리즘으로는 DES, TRiple-DES, RC2, RC4 등이 있다.


### 14.3.1 키 길이와 열거 공격(Enumeration Attack)

알고리즘은 공개 되어 있으므로, 비밀 키가 누설되면 안 된다.
가능한 키 값의 개수는 키가 몇 비트이며 얼마나 많은 키가 유효한지에 달려있다.


### 14.3.2 공유키 발급하기

대칭키 암호의 단점 중 하나는 발송자와 수신자가 서로 대화하기 위해서는 둘 다 공유키를 가져야 한다는 것이다. 
대화에 참여하는 각 쌍은 그들만의 개인 키를 가질 필요가 있다. 


## 14.4 공개키 암호법

한 쌍의 호스트가 하나의 인코딩/디코딩 키를 사용하는 대신, 공개키 암호 방식은 두 개의 비대칭 키를 사용한다. 
하나는 호스트의 메시지를 인코딩하기 위한 것이고, 다른 하나는 호스트의 메시지를 디코딩하기 위한 것이다.
인코딩 키는 모두를 위해 공개되어 있지만, 호스트만이 개인 디코딩 키를 알고 있다.

메시지의 인코딩은 누구나 할 수 있도록 해주는 동시에, 메시지를 디코딩하는 능력은 소유자에게만 부여한다.


### 14.4.1 RSA

### 14.4.2 혼성 암호 체계와 세션 키

공개키 암호 방식의 알고리즘은 계산이 느린 경향이 있어서 실제로는 대칭과 비대칭 방식을 섞은 것이 쓰인다.
예를 들어 노드들 사이의 안전한 의사소통 채널을 수립할 때는 공개 키 암호를 사용하고, 이렇게 만들어진 안전한 채널을 통해 임시의 무작위 대칭 키를 생성하고 교환하여 이후의 나머지 데이터를 암호화할 때는 빠른 대칭 키를 사용하는 방식이 흔히 쓰인다.


## 14.5 디지털 서명

### 14.5.1 서명은 암호 체크섬이다.

* 서명은 메시지를 작성한 저자가 누군지 알려준다. 오직 저자만이 체크섬을 계산할 수 있다.
* 서명은 메시지 위조를 방지한다. 악의적인 공격자가 송신 중인 메시지를 수정했다면 체크섬은 더 이상 그 메시지와 맞지 않게 된다.

디지털 서명은 보통 비대칭 공개키에 의해 생성된다.
개인 키는 오직 소유자만 알고 있기 때문에, 저자의 개인 키는 일종의 지문처럼 사용된다.




